(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[309],{7808:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>x});var l=a(7876),d=a(4250),t=a.n(d),n=a(4232),r=a(2829),i=a(7882);let c=[{key:"transactions",label:"Transa\xe7\xf5es"},{key:"plans",label:"Planos"},{key:"referrals",label:"Referrals"},{key:"contents",label:"Conte\xfados"}];function x(){let[e,s]=(0,n.useState)("transactions"),[a,d]=(0,n.useState)([]),[x,o]=(0,n.useState)([]),[j,m]=(0,n.useState)([]),[f,h]=(0,n.useState)([]),[u,N]=(0,n.useState)({name:"",frequency:""}),[p,b]=(0,n.useState)({1:"",2:""}),[g,y]=(0,n.useState)({}),[v,w]=(0,n.useState)("");async function k(){w("");let{data:e,error:s}=await r.N.from("transactions").select("*").order("created_at",{ascending:!1});s&&w(s.message),d(e||[]);let{data:a,error:l}=await r.N.from("plans").select("*");l&&w(l.message),o(a||[]);let{data:t,error:n}=await r.N.from("referral_configs").select("*");n&&w(n.message),m(t||[]),b((t||[]).reduce((e,s)=>(e[s.level]=s.percentage.toString(),e),{}));let{data:i,error:c}=await r.N.from("page_contents").select("*");c&&w(c.message),h(i||[]),y((i||[]).reduce((e,s)=>(e[s.slug]={title:s.title,body:s.body},e),{}))}(0,n.useEffect)(()=>{(async()=>{let{data:{session:e}}=await r.N.auth.getSession();if(!e){window.location.href="/login";return}let{data:s}=await r.N.from("user_profiles").select("role").eq("user_id",e.user.id).single();if(!s||"admin"!==s.role){alert("Acesso negado: apenas administradores."),window.location.href="/dashboard";return}k()})()},[]);let C=async e=>{await r.N.from("transactions").update({status:"approved"}).eq("id",e.id),k()},_=async e=>{await r.N.from("transactions").update({status:"rejected"}).eq("id",e.id),k()},q=async()=>{if(!u.name||!u.frequency)return void w("Preencha nome e frequ\xeancia do plano.");await r.N.from("plans").insert([u]),N({name:"",frequency:""}),k()},S=async e=>{await r.N.from("plans").update({name:e.name,frequency:e.frequency}).eq("id",e.id),k()},F=async e=>{confirm('Excluir plano "'.concat(e.name,'"?'))&&(await r.N.from("plans").delete().eq("id",e.id),k())},E=(e,s)=>{b(a=>({...a,[e]:s}))},P=async e=>{await r.N.from("referral_configs").update({percentage:parseFloat(p[e])}).eq("level",e),k()},A=(e,s,a)=>{y(l=>({...l,[e]:{...l[e],[s]:a}}))},T=async e=>{let{title:s,body:a}=g[e];await r.N.from("page_contents").update({title:s,body:a}).eq("slug",e),k()};return(0,l.jsxs)("div",{className:"jsx-253138980011f00d container",children:[(0,l.jsx)(i.A,{}),(0,l.jsx)("h1",{className:"jsx-253138980011f00d",children:"Painel Admin"}),v&&(0,l.jsx)("p",{className:"jsx-253138980011f00d error",children:v}),(0,l.jsx)("div",{className:"jsx-253138980011f00d tabs",children:c.map(a=>(0,l.jsx)("button",{onClick:()=>{w(""),s(a.key)},className:"jsx-253138980011f00d "+((e===a.key?"active":"")||""),children:a.label},a.key))}),(0,l.jsxs)("div",{className:"jsx-253138980011f00d tab-content",children:["transactions"===e&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("h2",{className:"jsx-253138980011f00d",children:"Transa\xe7\xf5es"}),(0,l.jsxs)("table",{className:"jsx-253138980011f00d table",children:[(0,l.jsx)("thead",{className:"jsx-253138980011f00d",children:(0,l.jsxs)("tr",{className:"jsx-253138980011f00d",children:[(0,l.jsx)("th",{className:"jsx-253138980011f00d",children:"ID"}),(0,l.jsx)("th",{className:"jsx-253138980011f00d",children:"Usu\xe1rio"}),(0,l.jsx)("th",{className:"jsx-253138980011f00d",children:"Tipo"}),(0,l.jsx)("th",{className:"jsx-253138980011f00d",children:"Valor"}),(0,l.jsx)("th",{className:"jsx-253138980011f00d",children:"Status"}),(0,l.jsx)("th",{className:"jsx-253138980011f00d",children:"A\xe7\xf5es"})]})}),(0,l.jsx)("tbody",{className:"jsx-253138980011f00d",children:a.map(e=>(0,l.jsxs)("tr",{className:"jsx-253138980011f00d",children:[(0,l.jsx)("td",{className:"jsx-253138980011f00d",children:e.id}),(0,l.jsx)("td",{className:"jsx-253138980011f00d",children:e.user_id}),(0,l.jsx)("td",{className:"jsx-253138980011f00d",children:e.type}),(0,l.jsxs)("td",{className:"jsx-253138980011f00d",children:["$",parseFloat(e.amount||0).toFixed(2)]}),(0,l.jsx)("td",{className:"jsx-253138980011f00d",children:e.status}),(0,l.jsx)("td",{className:"jsx-253138980011f00d",children:"pending"===e.status&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("button",{onClick:()=>C(e),className:"jsx-253138980011f00d",children:"✔️"}),(0,l.jsx)("button",{onClick:()=>_(e),className:"jsx-253138980011f00d",children:"✖️"})]})})]},e.id))})]})]}),"plans"===e&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("h2",{className:"jsx-253138980011f00d",children:"Planos"}),(0,l.jsxs)("div",{className:"jsx-253138980011f00d plans-admin",children:[(0,l.jsxs)("div",{className:"jsx-253138980011f00d plan-form",children:[(0,l.jsx)("h3",{className:"jsx-253138980011f00d",children:"Novo Plano"}),(0,l.jsx)("input",{type:"text",placeholder:"Nome",value:u.name,onChange:e=>N(s=>({...s,name:e.target.value})),className:"jsx-253138980011f00d"}),(0,l.jsx)("input",{type:"text",placeholder:"Frequ\xeancia",value:u.frequency,onChange:e=>N(s=>({...s,frequency:e.target.value})),className:"jsx-253138980011f00d"}),(0,l.jsx)("button",{onClick:q,className:"jsx-253138980011f00d",children:"Adicionar"})]}),(0,l.jsxs)("table",{className:"jsx-253138980011f00d table",children:[(0,l.jsx)("thead",{className:"jsx-253138980011f00d",children:(0,l.jsxs)("tr",{className:"jsx-253138980011f00d",children:[(0,l.jsx)("th",{className:"jsx-253138980011f00d",children:"ID"}),(0,l.jsx)("th",{className:"jsx-253138980011f00d",children:"Nome"}),(0,l.jsx)("th",{className:"jsx-253138980011f00d",children:"Freq"}),(0,l.jsx)("th",{className:"jsx-253138980011f00d",children:"A\xe7\xf5es"})]})}),(0,l.jsx)("tbody",{className:"jsx-253138980011f00d",children:x.map(e=>(0,l.jsxs)("tr",{className:"jsx-253138980011f00d",children:[(0,l.jsx)("td",{className:"jsx-253138980011f00d",children:e.id}),(0,l.jsx)("td",{className:"jsx-253138980011f00d",children:(0,l.jsx)("input",{value:e.name,onChange:s=>e.name=s.target.value,className:"jsx-253138980011f00d"})}),(0,l.jsx)("td",{className:"jsx-253138980011f00d",children:(0,l.jsx)("input",{value:e.frequency,onChange:s=>e.frequency=s.target.value,className:"jsx-253138980011f00d"})}),(0,l.jsxs)("td",{className:"jsx-253138980011f00d",children:[(0,l.jsx)("button",{onClick:()=>S(e),className:"jsx-253138980011f00d",children:"Salvar"}),(0,l.jsx)("button",{onClick:()=>F(e),className:"jsx-253138980011f00d",children:"Excluir"})]})]},e.id))})]})]})]}),"referrals"===e&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("h2",{className:"jsx-253138980011f00d",children:"Referral Config"}),(0,l.jsxs)("table",{className:"jsx-253138980011f00d table",children:[(0,l.jsx)("thead",{className:"jsx-253138980011f00d",children:(0,l.jsxs)("tr",{className:"jsx-253138980011f00d",children:[(0,l.jsx)("th",{className:"jsx-253138980011f00d",children:"N\xedvel"}),(0,l.jsx)("th",{className:"jsx-253138980011f00d",children:"%"}),(0,l.jsx)("th",{className:"jsx-253138980011f00d",children:"A\xe7\xf5es"})]})}),(0,l.jsx)("tbody",{className:"jsx-253138980011f00d",children:j.map(e=>(0,l.jsxs)("tr",{className:"jsx-253138980011f00d",children:[(0,l.jsx)("td",{className:"jsx-253138980011f00d",children:e.level}),(0,l.jsx)("td",{className:"jsx-253138980011f00d",children:(0,l.jsx)("input",{type:"number",step:"0.01",value:p[e.level],onChange:s=>E(e.level,s.target.value),className:"jsx-253138980011f00d"})}),(0,l.jsx)("td",{className:"jsx-253138980011f00d",children:(0,l.jsx)("button",{onClick:()=>P(e.level),className:"jsx-253138980011f00d",children:"Salvar"})})]},e.level))})]})]}),"contents"===e&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("h2",{className:"jsx-253138980011f00d",children:"Conte\xfados"}),f.map(e=>{var s,a;return(0,l.jsxs)("div",{className:"jsx-253138980011f00d content-admin",children:[(0,l.jsx)("h3",{className:"jsx-253138980011f00d",children:"sobre"===e.slug?"Sobre o InvestPro":"Manual de Uso"}),(0,l.jsxs)("label",{className:"jsx-253138980011f00d",children:["T\xedtulo:",(0,l.jsx)("input",{type:"text",value:(null==(s=g[e.slug])?void 0:s.title)||"",onChange:s=>A(e.slug,"title",s.target.value),className:"jsx-253138980011f00d"})]}),(0,l.jsxs)("label",{className:"jsx-253138980011f00d",children:["Corpo (HTML):",(0,l.jsx)("textarea",{rows:6,value:(null==(a=g[e.slug])?void 0:a.body)||"",onChange:s=>A(e.slug,"body",s.target.value),className:"jsx-253138980011f00d"})]}),(0,l.jsx)("button",{onClick:()=>T(e.slug),className:"jsx-253138980011f00d",children:"Salvar"})]},e.slug)})]})]}),(0,l.jsx)(t(),{id:"253138980011f00d",children:".tabs.jsx-253138980011f00d{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:.5rem;margin-bottom:1rem}.tabs.jsx-253138980011f00d button.jsx-253138980011f00d{padding:.5rem 1rem}.tabs.jsx-253138980011f00d button.active.jsx-253138980011f00d{font-weight:bold;text-decoration:underline}.table.jsx-253138980011f00d{width:100%;border-collapse:collapse;margin-bottom:1rem}.table.jsx-253138980011f00d th.jsx-253138980011f00d,.table.jsx-253138980011f00d td.jsx-253138980011f00d{border:1px solid#ddd;padding:.5rem;text-align:left}.plans-admin.jsx-253138980011f00d{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:2rem}.plan-form.jsx-253138980011f00d{-webkit-box-flex:0;-webkit-flex:0 0 200px;-moz-box-flex:0;-ms-flex:0 0 200px;flex:0 0 200px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;gap:.5rem}.content-admin.jsx-253138980011f00d{border:1px solid#ccc;padding:1rem;margin-bottom:1rem}label.jsx-253138980011f00d{display:block;margin:.5rem 0}input.jsx-253138980011f00d,textarea.jsx-253138980011f00d{width:100%;padding:.3rem}button.jsx-253138980011f00d{margin-right:.5rem}.error.jsx-253138980011f00d{color:red}"})]})}},8210:(e,s,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin",function(){return a(7808)}])}},e=>{var s=s=>e(e.s=s);e.O(0,[879,92,79,636,593,792],()=>s(8210)),_N_E=e.O()}]);